version: '3'

x-airflow-common: &airflow-common
  image: apache/airflow:2.9.2
  env_file:
    - .env
  volumes:
    - C:/airflow_data/dags:/opt/airflow/dags
    - C:/airflow_data/logs:/opt/airflow/logs
    - C:/airflow_data/plugins:/opt/airflow/plugins
    - C:/airflow_data/db:/opt/airflow
  user: "${AIRFLOW_UID:-50000}:0"

services:
  airflow-webserver:
    <<: *airflow-common
    container_name: proyect-machine-airflow-webserver
    ports:
      - "8080:8080"
    command: webserver
    depends_on:
      - airflow-scheduler

  airflow-scheduler:
    <<: *airflow-common
    container_name: proyect-machine-airflow-scheduler
    command: scheduler
